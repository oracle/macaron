# Implementation of Heuristic Malware Detector

## Check

We schedule the heuristics sequentially:

1. **Empty Project Link**: If the package contains project links (e.g., documentation, Git Repositories),
the analyzer will further operate the heuristic `Unreachable Project Links` to analyze if all the project links are unreachable.
2. **One Release**: Checks if there is only one release of the package. If the package contains multiple
releases, the checker will further check the release frequency through `High Release Frequency` and
`Unchanged Release` to see if the maintainers release multiple times in a short timeframe (threshold), and
whether the contents of the releases are identical.
3. **Closer Release Join Date**: Considers the date when the maintainer registered their account (if
available). The checker will calculate the gap between the latest release date and the maintainer's account
registration date.
4. **Suspicious Setup**: Checks whether the `setup.py` includes suspicious imports, such as `base64` for
encryption and `requests` for data exfiltration.

## Supported Ecosystem: PyPI

Define Seven Heuristics: `False` means suspicious and `True` means benign. `SKIP` means some metadata is missing, and the checker will skip the heuristic.

1. **Empty Project Link**
   - **Description**: Checks whether the package contains any project links (e.g., documents or Git
   Repositories). Many malicious activities do not include any project links.
   - **Rule**: Return `FALSE` when there is only one project link; otherwise, return `TRUE`.

2. **Unreachable Project Links**
   - **Description**: Checks the accessibility of the project links. This is considered an auxiliary
   heuristic since no cases have met this heuristic.
   - **Rule**: Return `FALSE` if all project links are unreachable; otherwise, return `TRUE`.

3. **One Release**
   - **Description**: Checks whether the package has only one release.
   - **Rule**: Return `FALSE` if the package contains only one release; otherwise, return `TRUE`.

4. **High Release Frequency**
   - **Description**: Checks if the package released multiple versions within a short timeframe. We calculate
   the release frequency and define a default frequency threshold of 2 days.
   - **Rule**: Return `FALSE` if the frequency is higher than the threshold; otherwise, return `TRUE`.

5. **Unchanged Release**
   - **Description**: Checks if the content of releases remains unchanged.
   - **Rule**: Return `FALSE` if the content of releases is identical; otherwise, return `TRUE`.

6. **Closer Release Join Date**
   - **Description**: Checks the gap between the date the maintainer registered their account and the date
   of the latest release. A default threshold of 5 days is defined.
   - **Rule**: Return `FALSE` if the gap is less than the threshold; otherwise, return `TRUE`.

7. **Suspicious Setup**
   - **Description**: Checks the `setup.py` to see if there are suspicious imported modules, or
   `install_requires` packages that are installed during the package installation process. We define two suspicious
   keywords as the blacklist.
   - **Rule**: Return `FALSE` if the package name contains suspicious keywords; otherwise, return `TRUE`.

## Heuristics-Based Analyzer: Scanning 1167 Packages from Trusted Organizations

| Heuristic Name   | Count |
|------------------| ----- |
| One Release      | 102   |
| Empty Link       | 45    |
| Links Missing    | 24    |
| Frequent Release | 14    |
| Suspicious Setup | 5     |

**The result is used as a reference for the confidence score to lower the false positive rate.**
