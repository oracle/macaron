# Copyright (c) 2024 - 2024, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/.


#This file defines the malicious pattern.
#The pattern is collected from the malware repository of Pypi.org.
imports:
- requests
- base64
- Fernet
- telebot
- platform
- ClientSession
- socket
- os
- getpass
- telegram
- __pyarmor__
- urllib.request.urlopen
- subprocess
- Request

ast_calls:
  os_detection:
  - os.name
  code_execution:
  - exec
  - subprocess.run
  - subprocess.call
  - subprocess.Popen
  - subprocess.check_call
  - os.system
  info_collecting:
  - os.getcwd
  - os.getlogin
  - os.getenv
  - os.environ
  - os.uname
  - getpass.getuser
  - socket.gethostname
  - platform.node
  - platform.system
  - platform.version
  - keyboard.on_release
  obfuscation:
  - base64.b64decode
  - __pyarmor__
        # - Fernet.decrypt
  remote_connection:
  - requests.get
  - requests.post
  - telegram.send_document
  - urllib.request.urlopen
  - urllib.request.urlretrieve
  - Request
  - socket.socket
  custom_setup:
  - install
  reverse_shell:
  - os.dup2

ast_constant:
  domains:
  - webhook.site
  - discord
  - cdn.discordapp.com
  - oast.fun
  - api.telegram.org
  - diddlydingusdu.de       # builderknower2
  - pipedream.net       # business-kpi-manager
  - 2.tcp.ngrok.io
  - files.pypihosted.org
  - filebin.net
  - akinasouls.fr
  - api.ipify.org       # Get public IP of the victim
  - httpbin.or
  - ngrok.ap
  - oastify.com
  - pythonanywhere.com
  - deliverycontent.online
  local_path:
  - /storage/emulated/0       # Android: primary user account on the device
  - /etc/resolv.conf       # DNS
  - /etc/hosts       # DNS
  - /sys/class/net       # Network related
  - /run/systemd/resolve/stub-resolv.conf
  - /sdcard/DCIM       # Photo storage
  executable:
  - .exe
  windows:
  - APPDATA
  - Start-Process       # Execute command
  - powershell
  reverse_shell:
  - /dev/tcp
  os_detection:
  - nt       # Windows
  - Windows
  - Darwin       # MacOS
  - Linux
  - posix       # Linux
