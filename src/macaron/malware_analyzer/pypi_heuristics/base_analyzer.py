# Copyright (c) 2024 - 2024, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/.

"""Define and initialize the base analyzer."""

import abc
from abc import abstractmethod

from macaron.json_tools import JsonType
from macaron.malware_analyzer.pypi_heuristics.heuristics import HeuristicResult, Heuristics
from macaron.slsa_analyzer.package_registry.pypi_registry import PyPIPackageJsonAsset


class BaseHeuristicAnalyzer(abc.ABC):
    """The base analyzer initialization."""

    def __init__(
        self,
        name: str,
        heuristic: Heuristics,
        depends_on: list[tuple[Heuristics, HeuristicResult]] | None,
    ) -> None:
        self.name: str = name
        self.heuristic: Heuristics = heuristic
        self.depends_on: list[tuple[Heuristics, HeuristicResult]] | None = (
            depends_on  # Contains the dependent heuristics and the expected result of each heuristic
        )

    @abstractmethod
    def analyze(self, pypi_package_json: PyPIPackageJsonAsset) -> tuple[HeuristicResult, dict[str, JsonType]]:
        """
        Implement the base analyze method for seven analyzers.

        Parameters
        ----------
        pypi_package_json: PyPIPackageJsonAsset
            The PyPI package JSON asset object.

        Returns
        -------
        tuple[HeuristicResult, dict[str, JsonType]]:
            The result and related information collected during the analysis.
        """
