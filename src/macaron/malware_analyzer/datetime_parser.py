# Copyright (c) 2023 - 2024, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/.

"""This module provides a helper function for safely parsing datetime strings."""

import logging
from datetime import datetime

logger = logging.getLogger(__name__)


def parse_datetime(datetime_str: str, datetime_format: str = "%Y-%m-%dT%H:%M:%S") -> datetime | None:
    """Parse a datetime string and handle errors.

    Args
    ----
        datetime_str (str): The datetime string to parse.
        datetime_format (str): The format to use for parsing the datetime string.

    Returns
    -------
        datetime: The parsed datetime object, or None if parsing failed.
    """
    try:
        return datetime.strptime(datetime_str, datetime_format)
    except ValueError as e:
        logger.debug("Failed to parse date string '%s' with format '%s': %s", datetime_str, datetime_format, e)
        return None
