#include "prelude.dl"

Policy("check-dependencies", component_id, "Check the dependencies of component.") :-
  transitive_dependency(component_id, dependency),
  check_passed(component_id, "mcn_detect_malicious_metadata_1"),
  check_passed(dependency, "mcn_detect_malicious_metadata_1").

apply_policy_to("check-dependencies", component_id) :-
    is_component(component_id, purl),
    match("<PACKAGE_PURL>@.*", purl).
