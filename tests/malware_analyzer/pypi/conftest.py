# Copyright (c) 2024 - 2024, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/.

"""This module contains test configurations for malware analyzer."""

from unittest.mock import MagicMock

import pytest

from macaron.database.table_definitions import Analysis, Component, RepoFinderMetadata
from macaron.slsa_analyzer.package_registry.pypi_registry import PyPIPackageJsonAsset, PyPIRegistry


@pytest.fixture(autouse=True)
def pypi_package_json() -> MagicMock:
    """Fixture for setting a mock PyPI package JSON asset object.

    Returns
    -------
    MagicMock:
        A PyPIPackageJsonAsset MagicMock.
    """
    pypi_registry = MagicMock(spec=PyPIRegistry)
    pypi_package = MagicMock(spec=PyPIPackageJsonAsset)
    pypi_package.pypi_registry = pypi_registry
    pypi_package.component = Component(
        purl="pkg:pypi/package", analysis=Analysis(), repository=None, repo_finder_metadata=RepoFinderMetadata()
    )
    return pypi_package
